{"paragraphs":[{"text":"import org.apache.spark.ml.recommendation.ALS\n\nval ratings = spark.read.option(\"header\", true).\n    option(\"inferSchema\", true).\n    csv(\"file:///Users/Lee/Desktop/dataset/anime-recommendations-database/rating.csv\")\nval anime = spark.read.option(\"header\", true).\n    option(\"inferSchema\", true).\n    csv(\"file:///Users/Lee/Desktop/dataset/anime-recommendations-database/anime.csv\")\nratings.show(false)\nanime.show(false)","user":"anonymous","dateUpdated":"2019-09-13T22:41:09+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.recommendation.ALS\nratings: org.apache.spark.sql.DataFrame = [user_id: int, anime_id: int ... 1 more field]\nanime: org.apache.spark.sql.DataFrame = [anime_id: int, name: string ... 5 more fields]\n+-------+--------+------+\n|user_id|anime_id|rating|\n+-------+--------+------+\n|1      |20      |-1    |\n|1      |24      |-1    |\n|1      |79      |-1    |\n|1      |226     |-1    |\n|1      |241     |-1    |\n|1      |355     |-1    |\n|1      |356     |-1    |\n|1      |442     |-1    |\n|1      |487     |-1    |\n|1      |846     |-1    |\n|1      |936     |-1    |\n|1      |1546    |-1    |\n|1      |1692    |-1    |\n|1      |1836    |-1    |\n|1      |2001    |-1    |\n|1      |2025    |-1    |\n|1      |2144    |-1    |\n|1      |2787    |-1    |\n|1      |2993    |-1    |\n|1      |3455    |-1    |\n+-------+--------+------+\nonly showing top 20 rows\n\r\n+--------+---------------------------------------------------------+----------------------------------------------------------------------------+-----+--------+------+-------+\n|anime_id|name                                                     |genre                                                                       |type |episodes|rating|members|\n+--------+---------------------------------------------------------+----------------------------------------------------------------------------+-----+--------+------+-------+\n|32281   |Kimi no Na wa.                                           |Drama, Romance, School, Supernatural                                        |Movie|1       |9.37  |200630 |\n|5114    |Fullmetal Alchemist: Brotherhood                         |Action, Adventure, Drama, Fantasy, Magic, Military, Shounen                 |TV   |64      |9.26  |793665 |\n|28977   |Gintama°                                                 |Action, Comedy, Historical, Parody, Samurai, Sci-Fi, Shounen                |TV   |51      |9.25  |114262 |\n|9253    |Steins;Gate                                              |Sci-Fi, Thriller                                                            |TV   |24      |9.17  |673572 |\n|9969    |Gintama&#039;                                            |Action, Comedy, Historical, Parody, Samurai, Sci-Fi, Shounen                |TV   |51      |9.16  |151266 |\n|32935   |Haikyuu!!: Karasuno Koukou VS Shiratorizawa Gakuen Koukou|Comedy, Drama, School, Shounen, Sports                                      |TV   |10      |9.15  |93351  |\n|11061   |Hunter x Hunter (2011)                                   |Action, Adventure, Shounen, Super Power                                     |TV   |148     |9.13  |425855 |\n|820     |Ginga Eiyuu Densetsu                                     |Drama, Military, Sci-Fi, Space                                              |OVA  |110     |9.11  |80679  |\n|15335   |Gintama Movie: Kanketsu-hen - Yorozuya yo Eien Nare      |Action, Comedy, Historical, Parody, Samurai, Sci-Fi, Shounen                |Movie|1       |9.1   |72534  |\n|15417   |Gintama&#039;: Enchousen                                 |Action, Comedy, Historical, Parody, Samurai, Sci-Fi, Shounen                |TV   |13      |9.11  |81109  |\n|4181    |Clannad: After Story                                     |Drama, Fantasy, Romance, Slice of Life, Supernatural                        |TV   |24      |9.06  |456749 |\n|28851   |Koe no Katachi                                           |Drama, School, Shounen                                                      |Movie|1       |9.05  |102733 |\n|918     |Gintama                                                  |Action, Comedy, Historical, Parody, Samurai, Sci-Fi, Shounen                |TV   |201     |9.04  |336376 |\n|2904    |Code Geass: Hangyaku no Lelouch R2                       |Action, Drama, Mecha, Military, Sci-Fi, Super Power                         |TV   |25      |8.98  |572888 |\n|28891   |Haikyuu!! Second Season                                  |Comedy, Drama, School, Shounen, Sports                                      |TV   |25      |8.93  |179342 |\n|199     |Sen to Chihiro no Kamikakushi                            |Adventure, Drama, Supernatural                                              |Movie|1       |8.93  |466254 |\n|23273   |Shigatsu wa Kimi no Uso                                  |Drama, Music, Romance, School, Shounen                                      |TV   |22      |8.92  |416397 |\n|24701   |Mushishi Zoku Shou 2nd Season                            |Adventure, Fantasy, Historical, Mystery, Seinen, Slice of Life, Supernatural|TV   |10      |8.88  |75894  |\n|12355   |Ookami Kodomo no Ame to Yuki                             |Fantasy, Slice of Life                                                      |Movie|1       |8.84  |226193 |\n|1575    |Code Geass: Hangyaku no Lelouch                          |Action, Mecha, Military, School, Sci-Fi, Super Power                        |TV   |25      |8.83  |715151 |\n+--------+---------------------------------------------------------+----------------------------------------------------------------------------+-----+--------+------+-------+\nonly showing top 20 rows\n\r\n"}]},"apps":[],"jobName":"paragraph_1568341448616_203574865","id":"20190913-112408_920695659","dateCreated":"2019-09-13T11:24:08+0900","dateStarted":"2019-09-13T22:41:09+0900","dateFinished":"2019-09-13T22:42:11+0900","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:335","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.56.1:4041/jobs/job?id=0","http://192.168.56.1:4041/jobs/job?id=1","http://192.168.56.1:4041/jobs/job?id=2","http://192.168.56.1:4041/jobs/job?id=3","http://192.168.56.1:4041/jobs/job?id=4","http://192.168.56.1:4041/jobs/job?id=5"],"interpreterSettingId":"spark"}}},{"text":"ratings.createOrReplaceTempView(\"ratings\")\nanime.createOrReplaceTempView(\"anime\")","user":"anonymous","dateUpdated":"2019-09-13T22:42:18+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1568363079401_1909330639","id":"20190913-172439_196257278","dateCreated":"2019-09-13T17:24:39+0900","dateStarted":"2019-09-13T22:42:18+0900","dateFinished":"2019-09-13T22:42:20+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:336"},{"text":"%sql\n\nSELECT *\n  FROM ratings","user":"anonymous","dateUpdated":"2019-09-13T22:42:27+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{"columns":[{"name":"user_id","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"anime_id","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"rating","visible":true,"width":"*","sort":{"priority":0,"direction":"asc"},"filters":[{}],"pinned":""}],"scrollFocus":{},"selection":[],"grouping":{"grouping":[],"aggregations":[],"rowExpandedStates":{}},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250}},"tableColumnTypeState":{"names":{"user_id":"string","anime_id":"string","rating":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"user_id\tanime_id\trating\n1\t20\t-1\n1\t24\t-1\n1\t79\t-1\n1\t226\t-1\n1\t241\t-1\n1\t355\t-1\n1\t356\t-1\n1\t442\t-1\n1\t487\t-1\n1\t846\t-1\n1\t936\t-1\n1\t1546\t-1\n1\t1692\t-1\n1\t1836\t-1\n1\t2001\t-1\n1\t2025\t-1\n1\t2144\t-1\n1\t2787\t-1\n1\t2993\t-1\n1\t3455\t-1\n1\t4063\t-1\n1\t4214\t-1\n1\t4224\t-1\n1\t4581\t-1\n1\t4744\t-1\n1\t4898\t-1\n1\t4999\t-1\n1\t5034\t-1\n1\t5277\t-1\n1\t5667\t-1\n1\t5781\t-1\n1\t5958\t-1\n1\t6163\t-1\n1\t6205\t-1\n1\t6324\t-1\n1\t6500\t-1\n1\t6547\t-1\n1\t6682\t-1\n1\t6707\t-1\n1\t6747\t-1\n1\t6773\t-1\n1\t6793\t-1\n1\t7088\t-1\n1\t7148\t-1\n1\t7593\t-1\n1\t7739\t-1\n1\t7858\t-1\n1\t8074\t10\n1\t8407\t-1\n1\t8424\t-1\n1\t8525\t-1\n1\t8630\t-1\n1\t8841\t-1\n1\t9041\t-1\n1\t9062\t-1\n1\t9136\t-1\n1\t9181\t-1\n1\t9330\t-1\n1\t9367\t-1\n1\t9515\t-1\n1\t9581\t-1\n1\t9675\t-1\n1\t9750\t-1\n1\t9790\t-1\n1\t9919\t-1\n1\t10067\t-1\n1\t10073\t-1\n1\t10076\t-1\n1\t10079\t-1\n1\t10080\t-1\n1\t10209\t-1\n1\t10578\t-1\n1\t10604\t-1\n1\t10719\t-1\n1\t10790\t-1\n1\t10793\t-1\n1\t10794\t-1\n1\t10805\t-1\n1\t10897\t-1\n1\t11161\t-1\n1\t11266\t-1\n1\t11617\t10\n1\t11737\t-1\n1\t11757\t10\n1\t11759\t-1\n1\t11771\t-1\n1\t12293\t-1\n1\t12549\t-1\n1\t12729\t-1\n1\t13357\t-1\n1\t13367\t-1\n1\t13411\t-1\n1\t13561\t-1\n1\t13663\t-1\n1\t13759\t-1\n1\t14749\t-1\n1\t14813\t-1\n1\t14833\t-1\n1\t14967\t-1\n1\t15117\t-1\n1\t15437\t-1\n1\t15451\t10\n1\t15583\t-1\n1\t15609\t-1\n1\t16011\t-1\n1\t16498\t-1\n1\t16706\t-1\n1\t17265\t-1\n1\t17729\t-1\n1\t18247\t-1\n1\t18277\t-1\n1\t18753\t-1\n1\t18897\t-1\n1\t19163\t-1\n1\t19221\t-1\n1\t19285\t-1\n1\t19429\t-1\n1\t19815\t-1\n1\t20045\t-1\n1\t20785\t-1\n1\t20787\t-1\n1\t21033\t-1\n1\t21881\t-1\n1\t22147\t-1\n1\t22199\t-1\n1\t22319\t-1\n1\t22535\t-1\n1\t22547\t-1\n1\t22663\t-1\n1\t22877\t-1\n1\t23233\t-1\n1\t23321\t-1\n1\t23847\t-1\n1\t24133\t-1\n1\t24455\t-1\n1\t24873\t-1\n1\t25099\t-1\n1\t25157\t-1\n1\t25159\t-1\n1\t25283\t-1\n1\t25397\t-1\n1\t26243\t-1\n1\t27775\t-1\n1\t27899\t-1\n1\t28121\t-1\n1\t28677\t-1\n1\t29093\t-1\n1\t29095\t-1\n1\t30015\t-1\n1\t30296\t-1\n1\t30544\t-1\n1\t31338\t-1\n1\t31845\t-1\n2\t11771\t10\n2\t12189\t-1\n2\t16417\t-1\n3\t20\t8\n3\t154\t6\n3\t170\t9\n3\t199\t10\n3\t225\t9\n3\t341\t6\n3\t430\t7\n3\t527\t7\n3\t552\t7\n3\t813\t10\n3\t1119\t7\n3\t1121\t7\n3\t1122\t7\n3\t1132\t8\n3\t1292\t6\n3\t1313\t8\n3\t1526\t7\n3\t1535\t10\n3\t1564\t7\n3\t1689\t8\n3\t1764\t6\n3\t1943\t8\n3\t2201\t7\n3\t2404\t7\n3\t2847\t7\n3\t3588\t8\n3\t4026\t7\n3\t5114\t10\n3\t5231\t8\n3\t6178\t7\n3\t6702\t8\n3\t6880\t6\n3\t7695\t7\n3\t8074\t6\n3\t9107\t6\n3\t9135\t7\n3\t9760\t9\n3\t9917\t8\n3\t9919\t8\n3\t9989\t10\n3\t10408\t7\n3\t10507\t8\n3\t11111\t8\n3\t11703\t6\n3\t11737\t7\n3\t11757\t9\n3\t11759\t7\n3\t11771\t10\n3\t12671\t3\n3\t14075\t8\n3\t14093\t7\n3\t14345\t8\n3\t14513\t10\n3\t16498\t10\n3\t16512\t5\n3\t16782\t7\n3\t16894\t10\n3\t16918\t8\n3\t17265\t7\n3\t18097\t7\n3\t18115\t10\n3\t18393\t7\n3\t19315\t3\n3\t19815\t9\n3\t20021\t5\n3\t20159\t10\n3\t20507\t8\n3\t20583\t9\n3\t21507\t6\n3\t21881\t7\n3\t22199\t8\n3\t22297\t8\n3\t22319\t6\n3\t22547\t6\n3\t22729\t7\n3\t23301\t8\n3\t23321\t6\n3\t23333\t4\n3\t23755\t8\n3\t24415\t10\n3\t26243\t6\n3\t27631\t8\n3\t27899\t8\n3\t28121\t9\n3\t28171\t10\n3\t28223\t6\n3\t28497\t7\n3\t28701\t9\n3\t28891\t9\n3\t29854\t6\n3\t30276\t-1\n3\t30503\t-1\n3\t31043\t10\n3\t31859\t7\n4\t6\t-1\n4\t72\t-1\n4\t121\t-1\n4\t150\t-1\n4\t166\t-1\n4\t205\t-1\n4\t226\t-1\n4\t857\t-1\n4\t1292\t-1\n4\t1498\t-1\n4\t1535\t-1\n4\t1691\t-1\n4\t2025\t-1\n4\t2966\t-1\n4\t2993\t-1\n4\t3588\t-1\n4\t4063\t-1\n4\t4214\t-1\n4\t4970\t-1\n4\t5341\t-1\n4\t6347\t-1\n4\t6547\t-1\n4\t6702\t-1\n4\t6747\t-1\n4\t7088\t-1\n4\t8525\t-1\n4\t9919\t-1\n4\t10165\t-1\n4\t10620\t-1\n4\t11757\t-1\n4\t14513\t-1\n4\t14765\t-1\n4\t16009\t-1\n4\t16498\t-1\n4\t16742\t-1\n4\t16890\t-1\n4\t17265\t-1\n4\t17505\t-1\n4\t17777\t-1\n4\t18115\t-1\n4\t18153\t-1\n4\t18229\t-1\n4\t18507\t-1\n4\t18679\t-1\n4\t19769\t-1\n4\t20053\t-1\n4\t20431\t-1\n4\t20689\t-1\n4\t20931\t-1\n4\t20973\t-1\n4\t21067\t-1\n4\t21085\t-1\n5\t6\t8\n5\t15\t6\n5\t17\t6\n5\t18\t6\n5\t20\t6\n5\t22\t5\n5\t24\t1\n5\t30\t1\n5\t45\t7\n5\t47\t8\n5\t57\t7\n5\t63\t1\n5\t67\t6\n5\t68\t6\n5\t132\t6\n5\t136\t8\n5\t137\t8\n5\t138\t6\n5\t139\t6\n5\t150\t2\n5\t152\t4\n5\t166\t6\n5\t170\t6\n5\t174\t5\n5\t185\t6\n5\t186\t6\n5\t189\t1\n5\t190\t1\n5\t195\t4\n5\t199\t8\n5\t205\t8\n5\t223\t6\n5\t225\t1\n5\t232\t3\n5\t240\t4\n5\t241\t1\n5\t245\t10\n5\t248\t1\n5\t249\t1\n5\t250\t5\n5\t263\t7\n5\t264\t8\n5\t265\t7\n5\t268\t7\n5\t269\t3\n5\t272\t5\n5\t288\t2\n5\t292\t7\n5\t335\t3\n5\t344\t7\n5\t371\t3\n5\t379\t6\n5\t390\t3\n5\t392\t7\n5\t406\t6\n5\t442\t4\n5\t443\t4\n5\t448\t3\n5\t481\t3\n5\t482\t5\n5\t487\t1\n5\t508\t3\n5\t517\t3\n5\t527\t6\n5\t528\t7\n5\t534\t7\n5\t550\t2\n5\t552\t7\n5\t709\t6\n5\t760\t2\n5\t761\t5\n5\t813\t5\n5\t846\t1\n5\t861\t2\n5\t874\t7\n5\t896\t4\n5\t898\t5\n5\t903\t1\n5\t905\t6\n5\t914\t7\n5\t918\t9\n5\t936\t5\n5\t981\t5\n5\t987\t2\n5\t1117\t7\n5\t1132\t5\n5\t1138\t5\n5\t1195\t1\n5\t1210\t4\n5\t1253\t7\n5\t1254\t7\n5\t1257\t7\n5\t1313\t6\n5\t1469\t5\n5\t1535\t4\n5\t1559\t5\n5\t1564\t5\n5\t1614\t5\n5\t1668\t2\n5\t1669\t2\n5\t1674\t5\n5\t1685\t-1\n5\t1689\t7\n5\t1764\t6\n5\t1840\t1\n5\t1887\t3\n5\t1913\t8\n5\t1956\t2\n5\t2034\t3\n5\t2104\t1\n5\t2116\t5\n5\t2144\t1\n5\t2159\t7\n5\t2236\t8\n5\t2248\t5\n5\t2330\t5\n5\t2363\t6\n5\t2397\t7\n5\t2398\t7\n5\t2400\t6\n5\t2418\t9\n5\t2424\t3\n5\t2472\t5\n5\t2508\t3\n5\t2594\t8\n5\t2605\t7\n5\t2684\t6\n5\t2789\t1\n5\t2907\t5\n5\t2961\t6\n5\t2962\t6\n5\t2993\t2\n5\t3228\t7\n5\t3455\t2\n5\t3503\t1\n5\t3515\t7\n5\t3588\t5\n5\t3655\t5\n5\t3702\t9\n5\t3712\t1\n5\t3887\t7\n5\t3974\t5\n5\t4015\t1\n5\t4052\t5\n5\t4063\t2\n5\t4106\t-1\n5\t4214\t2\n5\t4224\t3\n5\t4437\t5\n5\t4472\t3\n5\t4548\t5\n5\t4654\t6\n5\t4667\t1\n5\t4760\t1\n5\t4975\t1\n5\t4999\t5\n5\t5040\t8\n5\t5042\t1\n5\t5081\t-1\n5\t5251\t8\n5\t5258\t8\n5\t5277\t1\n5\t5279\t2\n5\t5526\t6\n5\t5667\t2\n5\t5680\t1\n5\t5681\t6\n5\t5958\t2\n5\t6098\t5\n5\t6201\t2\n5\t6211\t8\n5\t6324\t2\n5\t6325\t5\n5\t6347\t1\n5\t6377\t7\n5\t6385\t6\n5\t6512\t2\n5\t6547\t3\n5\t6695\t5\n5\t6702\t4\n5\t6746\t7\n5\t6791\t1\n5\t6885\t3\n5\t6956\t2\n5\t6974\t6\n5\t7088\t1\n5\t7148\t1\n5\t7593\t1\n5\t7647\t8\n5\t7661\t8\n5\t7674\t5\n5\t7720\t7\n5\t7762\t7\n5\t7769\t2\n5\t7791\t2\n5\t7817\t2\n5\t7858\t1\n5\t8074\t2\n5\t8277\t3\n5\t8302\t2\n5\t8407\t1\n5\t8408\t7\n5\t8424\t4\n5\t8457\t5\n5\t8516\t1\n5\t8525\t3\n5\t8619\t2\n5\t8675\t6\n5\t8769\t1\n5\t8841\t5\n5\t9041\t2\n5\t9074\t8\n5\t9181\t1\n5\t9220\t5\n5\t9253\t9\n5\t9355\t1\n5\t9367\t1\n5\t9379\t5\n5\t9471\t1\n5\t9479\t7\n5\t9741\t2\n5\t9919\t4\n5\t9936\t2\n5\t9969\t9\n5\t9981\t5\n5\t9989\t7\n5\t10020\t1\n5\t10030\t5\n5\t10080\t3\n5\t10108\t1\n5\t10110\t3\n5\t10119\t7\n5\t10162\t7\n5\t10163\t7\n5\t10172\t1\n5\t10209\t5\n5\t10216\t6\n5\t10396\t4\n5\t10397\t1\n5\t10521\t4\n5\t10589\t4\n5\t10638\t5\n5\t10719\t7\n5\t10790\t6\n5\t10805\t5\n5\t10863\t8\n5\t10897\t3\n5\t11013\t1\n5\t11113\t7\n5\t11179\t5\n5\t11319\t1\n5\t11371\t3\n5\t11433\t5\n5\t11499\t5\n5\t11577\t9\n5\t11597\t-1\n5\t11617\t2\n5\t11633\t7\n5\t11757\t1\n5\t11759\t3\n5\t11761\t4\n5\t11785\t3\n5\t11813\t5\n5\t11843\t8\n5\t11853\t6\n5\t12069\t7\n5\t12189\t5\n5\t12431\t8\n5\t12445\t4\n5\t12447\t4\n5\t12467\t5\n5\t12549\t2\n5\t12581\t3\n5\t12673\t5\n5\t12729\t1\n5\t13055\t5\n5\t13093\t5\n5\t13161\t1\n5\t13201\t5\n5\t13333\t5\n5\t13357\t2\n5\t13367\t2\n5\t13403\t1\n5\t13479\t6\n5\t13535\t7\n5\t13659\t1\n5\t13663\t2\n5\t13759\t3\n5\t13851\t1\n5\t14027\t2\n5\t14189\t3\n5\t14199\t1\n5\t14227\t2\n5\t14349\t6\n5\t14467\t5\n5\t14513\t7\n5\t14527\t4\n5\t14669\t7\n5\t14685\t4\n5\t14719\t9\n5\t14741\t4\n5\t14749\t2\n5\t14813\t3\n5\t14833\t-1\n5\t14967\t3\n5\t15039\t7\n5\t15059\t6\n5\t15225\t3\n5\t15315\t5\n5\t15335\t10\n5\t15379\t5\n5\t15417\t8\n5\t15437\t5\n5\t15451\t1\n5\t15565\t4\n5\t15583\t3\n5\t15609\t1\n5\t15729\t1\n5\t15771\t8\n5\t15775\t7\n5\t15809\t7\n5\t16011\t2\n5\t16067\t5\n5\t16241\t7\n5\t16353\t1\n5\t16417\t3\n5\t16444\t5\n5\t16592\t5\n5\t16636\t5\n5\t16694\t5\n5\t16706\t2\n5\t16742\t5\n5\t16782\t7\n5\t16866\t2\n5\t16894\t5\n5\t16918\t7\n5\t17157\t1\n5\t17247\t2\n5\t17265\t8\n5\t17505\t6\n5\t17641\t2\n5\t17729\t1\n5\t17741\t2\n5\t17777\t1\n5\t17827\t1\n5\t17875\t5\n5\t17895\t4\n5\t18001\t4\n5\t18039\t2\n5\t18095\t3\n5\t18115\t7\n5\t18139\t4\n5\t18153\t5\n5\t18179\t6\n5\t18229\t5\n5\t18247\t1\n5\t18277\t2\n5\t18441\t7\n5\t18465\t2\n5\t18497\t5\n5\t18671\t4\n5\t18677\t3\n5\t18689\t8\n5\t18753\t3\n5\t18857\t1\n5\t18897\t2\n5\t19023\t2\n5\t19163\t2\n5\t19221\t7\n5\t19363\t6\n5\t19365\t5\n5\t19369\t3\n5\t19647\t8\n5\t19769\t3\n5\t19799\t1\n5\t19815\t1\n5\t19953\t4\n5\t20031\t5\n5\t20045\t1\n5\t20047\t1\n5\t20053\t3\n5\t20057\t8\n5\t20159\t7\n5\t20431\t6\n5\t20457\t1\n5\t20507\t6\n5\t20541\t1\n5\t20545\t3\n5\t20583\t8\n5\t20689\t3\n5\t20767\t7\n5\t20785\t1\n5\t20787\t3\n5\t20847\t6\n5\t20853\t3\n5\t20899\t8\n5\t20931\t1\n5\t20939\t6\n5\t20973\t5\n5\t20977\t3\n5\t21033\t1\n5\t21085\t4\n5\t21185\t5\n5\t21189\t3\n5\t21327\t6\n5\t21405\t4\n5\t21431\t3\n5\t21507\t1\n5\t21561\t3\n5\t21587\t5\n5\t21603\t3\n5\t21647\t5\n5\t21781\t3\n5\t21863\t6\n5\t22147\t6\n5\t22199\t4\n5\t22319\t2\n5\t22535\t7\n5\t22789\t8\n5\t23079\t2\n5\t23199\t7\n5\t23233\t1\n5\t23251\t7\n5\t23273\t8\n5\t23277\t4\n5\t23289\t5\n5\t23309\t1\n5\t23447\t5\n5\t23755\t7\n5\t23847\t4\n5\t24135\t5\n5\t24171\t5\n5\t24175\t4\n5\t24627\t5\n5\t24781\t6\n5\t24873\t1\n5\t24913\t4\n5\t25157\t1\n5\t25159\t2\n5\t25183\t6\n5\t25303\t-1\n5\t25397\t2\n5\t25429\t1\n5\t25635\t7\n5\t26055\t8\n5\t26349\t6\n5\t26441\t6\n5\t27899\t2\n5\t28121\t6\n5\t28297\t5\n5\t28677\t5\n5\t28819\t2\n5\t28891\t9\n5\t28907\t5\n5\t29027\t2\n5\t29035\t1\n5\t29317\t4\n5\t29785\t2\n5\t29786\t3\n5\t29803\t8\n5\t30831\t8\n5\t31240\t8\n5\t31636\t-1\n5\t31722\t7\n5\t31964\t-1\n5\t32182\t9\n5\t32828\t7\n6\t20\t-1\n6\t59\t-1\n6\t228\t-1\n6\t317\t-1\n6\t1311\t-1\n6\t1535\t-1\n6\t1594\t-1\n6\t1726\t-1\n6\t1818\t-1\n6\t2994\t-1\n6\t3713\t-1\n6\t4999\t-1\n6\t6045\t-1\n6\t6547\t-1\n6\t6880\t-1\n6\t7054\t-1\n6\t7059\t-1\n6\t8074\t-1\n6\t8425\t-1\n6\t8525\t-1\n6\t9515\t-1\n6\t9656\t-1\n6\t10067\t-1\n6\t10080\t-1\n6\t10418\t-1\n6\t10504\t-1\n6\t10719\t-1\n6\t10800\t-1\n6\t10897\t-1\n6\t11285\t-1\n6\t12079\t-1\n6\t12893\t-1\n6\t14027\t-1\n6\t14397\t-1\n6\t14967\t-1\n6\t16317\t-1\n6\t19285\t-1\n7\t22\t7\n7\t30\t10\n7\t31\t9\n7\t32\t9\n7\t59\t7\n7\t64\t8\n7\t65\t7\n7\t111\t8\n7\t121\t8\n7\t136\t8\n7\t139\t7\n7\t170\t9\n7\t210\t9\n7\t223\t9\n7\t225\t7\n7\t232\t8\n7\t245\t8\n7\t249\t8\n7\t270\t9\n7\t339\t9\n7\t357\t8\n7\t407\t8\n7\t435\t8\n7\t482\t9\n7\t508\t7\n7\t530\t8\n7\t532\t8\n7\t534\t9\n7\t535\t8\n7\t552\t9\n7\t568\t8\n7\t740\t8\n7\t813\t9\n7\t849\t7\n7\t934\t9\n7\t996\t8\n7\t1138\t8\n7\t1172\t8\n7\t1253\t7\n7\t1254\t8\n7\t1257\t7\n7\t1259\t7\n7\t1313\t8\n7\t1535\t9\n7\t1563\t8\n7\t1575\t9\n7\t1719\t7\n7\t1887\t8\n7\t1889\t9\n7\t2012\t8\n7\t2026\t9\n7\t2116\t9\n7\t2131\t8\n7\t2167\t9\n7\t2213\t9\n7\t2237\t6\n7\t2759\t9\n7\t2899\t8\n7\t2904\t9\n7\t2993\t7\n7\t2994\t8\n7\t3086\t8\n7\t3455\t7\n7\t3515\t7\n7\t3652\t8\n7\t3702\t7\n7\t3784\t8\n7\t3785\t9\n7\t4028\t8\n7\t4059\t9\n7\t4181\t9\n7\t4192\t9\n7\t4214\t7\n7\t4382\t4\n7\t4472\t7\n7\t4654\t9\n7\t4896\t10\n7\t4975\t9\n7\t5231\t8\n7\t5233\t8\n7\t5521\t8\n7\t5667\t7\n7\t5958\t8\n7\t6166\t6\n7\t6205\t8\n7\t6213\t7\n7\t6351\t8\n7\t6811\t8\n7\t6956\t7\n7\t7148\t6\n7\t7858\t7\n7\t8277\t6\n7\t8407\t7\n7\t8424\t7\n7\t8460\t7\n7\t8525\t8\n7\t8769\t8\n7\t8861\t7\n7\t8876\t7\n7\t8937\t9\n7\t9032\t7\n7\t9041\t8\n7\t9047\t8\n7\t9063\t7\n7\t9181\t7\n7\t9367\t5\n7\t9479\t8\n7\t9618\t7\n7\t9675\t7\n7\t9756\t8\n7\t9790\t7\n7\t9958\t9\n7\t10020\t8\n7\t10076\t8\n7\t10080\t7\n7\t10110\t6\n7\t10456\t7\n7\t10491\t8\n7\t10507\t7\n7\t10521\t7\n7\t10588\t7\n7\t10620\t8\n7\t10719\t8\n7\t10794\t7\n7\t10805\t6\n7\t10897\t7\n7\t11061\t9\n7\t11179\t8\n7\t11617\t6\n7\t11633\t8\n7\t11743\t8\n7\t11757\t8\n7\t11759\t8\n7\t11763\t7\n7\t11933\t8\n7\t11977\t8\n7\t11979\t8\n7\t11981\t9\n7\t12467\t7\n7\t12729\t7\n7\t12783\t8\n7\t12967\t7\n7\t13093\t7\n7\t13261\t7\n7\t13357\t5\n7\t13587\t9\n7\t13659\t7\n7\t13663\t8\n7\t13851\t7\n7\t13939\t7\n7\t14027\t6\n7\t14407\t8\n7\t14653\t10\n7\t14741\t7\n7\t14749\t7\n7\t14833\t8\n7\t14967\t7\n7\t15117\t8\n7\t15225\t7\n7\t15377\t6\n7\t15379\t8\n7\t15411\t7\n7\t15451\t8\n7\t15583\t7\n7\t15687\t5\n7\t15809\t7\n7\t15879\t6\n7\t15911\t6\n7\t16011\t8\n7\t16049\t9\n7\t16157\t7\n7\t16512\t4\n7\t16700\t8\n7\t16706\t9\n7\t16742\t6\n7\t16762\t7\n7\t16934\t7\n7\t16982\t10\n7\t17247\t7\n7\t17265\t9\n7\t17513\t7\n7\t17641\t7\n7\t17725\t7\n7\t17729\t8\n7\t17777\t7\n7\t17875\t8\n7\t18001\t5\n7\t18039\t7\n7\t18041\t7\n7\t18095\t7\n7\t18097\t7\n7\t18139\t8\n7\t18153\t8\n7\t18247\t8\n"},{"type":"HTML","data":"<div class=\"result-alert alert-warning\" role=\"alert\"><button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button><strong>Output is truncated</strong> to 1000 rows. Learn more about <strong>zeppelin.spark.maxResult</strong></div>"}]},"apps":[],"jobName":"paragraph_1568363100930_-1271527709","id":"20190913-172500_1032934036","dateCreated":"2019-09-13T17:25:00+0900","dateStarted":"2019-09-13T22:42:27+0900","dateFinished":"2019-09-13T22:42:27+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:337","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.56.1:4041/jobs/job?id=6"],"interpreterSettingId":"spark"}}},{"text":"val Array(training, test) = ratings.randomSplit(Array(0.8, 0.2))\nval als = new ALS().\n    setMaxIter(5).\n    setRegParam(0.01).\n    setUserCol(\"user_id\").\n    setItemCol(\"anime_id\").\n    setRatingCol(\"rating\")\nprintln(als.explainParams)","user":"anonymous","dateUpdated":"2019-09-13T22:42:34+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"training: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [user_id: int, anime_id: int ... 1 more field]\r\ntest: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [user_id: int, anime_id: int ... 1 more field]\nals: org.apache.spark.ml.recommendation.ALS = als_802c926f73f1\nalpha: alpha for implicit preference (default: 1.0)\ncheckpointInterval: set checkpoint interval (>= 1) or disable checkpoint (-1). E.g. 10 means that the cache will get checkpointed every 10 iterations (default: 10)\ncoldStartStrategy: strategy for dealing with unknown or new users/items at prediction time. This may be useful in cross-validation or production scenarios, for handling user/item ids the model has not seen in the training data. Supported values: nan,drop. (default: nan)\nfinalStorageLevel: StorageLevel for ALS model factors. (default: MEMORY_AND_DISK)\nimplicitPrefs: whether to use implicit preference (default: false)\nintermediateStorageLevel: StorageLevel for intermediate datasets. Cannot be 'NONE'. (default: MEMORY_AND_DISK)\nitemCol: column name for item ids. Ids must be within the integer value range. (default: item, current: anime_id)\nmaxIter: maximum number of iterations (>= 0) (default: 10, current: 5)\nnonnegative: whether to use nonnegative constraint for least squares (default: false)\nnumItemBlocks: number of item blocks (default: 10)\nnumUserBlocks: number of user blocks (default: 10)\npredictionCol: prediction column name (default: prediction)\nrank: rank of the factorization (default: 10)\nratingCol: column name for ratings (default: rating, current: rating)\nregParam: regularization parameter (>= 0) (default: 0.1, current: 0.01)\nseed: random seed (default: 1994790107)\nuserCol: column name for user ids. Ids must be within the integer value range. (default: user, current: user_id)\r\n"}]},"apps":[],"jobName":"paragraph_1568341798380_1497040543","id":"20190913-112958_1552668723","dateCreated":"2019-09-13T11:29:58+0900","dateStarted":"2019-09-13T22:42:34+0900","dateFinished":"2019-09-13T22:42:39+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:338"},{"text":"val alsModel = als.fit(training)\nval predictions = alsModel.transform(test)","user":"anonymous","dateUpdated":"2019-09-13T22:42:41+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"alsModel: org.apache.spark.ml.recommendation.ALSModel = als_802c926f73f1\npredictions: org.apache.spark.sql.DataFrame = [user_id: int, anime_id: int ... 2 more fields]\n"}]},"apps":[],"jobName":"paragraph_1568341766053_393069378","id":"20190913-112926_975005230","dateCreated":"2019-09-13T11:29:26+0900","dateStarted":"2019-09-13T22:42:41+0900","dateFinished":"2019-09-13T22:43:53+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:339","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.56.1:4041/jobs/job?id=7","http://192.168.56.1:4041/jobs/job?id=8","http://192.168.56.1:4041/jobs/job?id=9","http://192.168.56.1:4041/jobs/job?id=10","http://192.168.56.1:4041/jobs/job?id=11"],"interpreterSettingId":"spark"}}},{"text":"alsModel.recommendForAllUsers(10).\n    selectExpr(\"user_id\", \"explode(recommendations)\").show()\nalsModel.recommendForAllItems(10).\n    selectExpr(\"anime_id\", \"explode(recommendations)\").show()","user":"anonymous","dateUpdated":"2019-09-13T22:43:55+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------------------+\n|user_id|               col|\n+-------+------------------+\n|    148|  [6262,18.286133]|\n|    148|  [5688,17.903637]|\n|    148|  [3676,17.615305]|\n|    148| [20929,16.326649]|\n|    148|  [7416,16.239584]|\n|    148|   [2128,16.12163]|\n|    148|  [3905,15.890259]|\n|    148|  [4050,15.634267]|\n|    148| [32293,15.531559]|\n|    148|  [2892,15.370633]|\n|    463|   [2128,19.93574]|\n|    463| [33165,18.280363]|\n|    463| [23265,17.817886]|\n|    463|  [3827,16.082249]|\n|    463|  [2835,16.051931]|\n|    463| [15159,15.858603]|\n|    463|[23761,15.5337105]|\n|    463|  [6560,15.075818]|\n|    463|  [2052,14.997774]|\n|    463| [29681,14.848237]|\n+-------+------------------+\nonly showing top 20 rows\n\r\n+--------+-----------------+\n|anime_id|              col|\n+--------+-----------------+\n|    1580|[26290,34.272167]|\n|    1580| [4507,32.966408]|\n|    1580|[17401,31.693535]|\n|    1580| [3519,31.263098]|\n|    1580|[58467,30.650455]|\n|    1580|[61049,30.231089]|\n|    1580|[34550,30.094803]|\n|    1580| [72302,30.05686]|\n|    1580|[16418,29.856892]|\n|    1580|[32252,29.714485]|\n|    5300|[12452,21.611862]|\n|    5300|  [4447,21.57716]|\n|    5300|[26746,20.250996]|\n|    5300|[67157,19.426777]|\n|    5300| [52813,18.96327]|\n|    5300| [66486,18.36699]|\n|    5300| [46798,18.21629]|\n|    5300|[67734,18.099867]|\n|    5300|[28072,18.074383]|\n|    5300| [14499,18.04148]|\n+--------+-----------------+\nonly showing top 20 rows\n\r\n"}]},"apps":[],"jobName":"paragraph_1568342627291_-633006445","id":"20190913-114347_450563178","dateCreated":"2019-09-13T11:43:47+0900","dateStarted":"2019-09-13T22:43:55+0900","dateFinished":"2019-09-13T22:48:12+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:340","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.56.1:4041/jobs/job?id=12","http://192.168.56.1:4041/jobs/job?id=13"],"interpreterSettingId":"spark"}}},{"text":"","user":"anonymous","dateUpdated":"2019-09-13T22:55:53+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.evaluation.RegressionEvaluator\nevaluator: org.apache.spark.ml.evaluation.RegressionEvaluator = regEval_99493100f730\nrmse: Double = NaN\nRoot-mean-square error = NaN\r\n"}]},"apps":[],"jobName":"paragraph_1568344376205_-342907993","id":"20190913-121256_229413281","dateCreated":"2019-09-13T12:12:56+0900","dateStarted":"2019-09-13T22:48:26+0900","dateFinished":"2019-09-13T22:52:19+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:341","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.56.1:4041/jobs/job?id=14"],"interpreterSettingId":"spark"}}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1568380837116_1967802695","id":"20190913-222037_544350806","dateCreated":"2019-09-13T22:20:37+0900","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:342"}],"name":"animeRecommendation","id":"2EQ5GQTU2","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}