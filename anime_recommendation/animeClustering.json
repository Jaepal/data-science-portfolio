{"paragraphs":[{"text":"val ratings = spark.read.option(\"header\", true).\n    option(\"inferSchema\", true).\n    csv(\"file:///Users/Lee/Desktop/dataset/anime-recommendations-database/rating.csv\")\nval anime = spark.read.option(\"header\", true).\n    option(\"inferSchema\", true).\n    csv(\"file:///Users/Lee/Desktop/dataset/anime-recommendations-database/anime.csv\")\nratings.show(false)\nanime.show(false)","user":"anonymous","dateUpdated":"2019-09-25T21:46:32+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ratings: org.apache.spark.sql.DataFrame = [user_id: int, anime_id: int ... 1 more field]\nanime: org.apache.spark.sql.DataFrame = [anime_id: int, name: string ... 5 more fields]\n+-------+--------+------+\n|user_id|anime_id|rating|\n+-------+--------+------+\n|1      |20      |-1    |\n|1      |24      |-1    |\n|1      |79      |-1    |\n|1      |226     |-1    |\n|1      |241     |-1    |\n|1      |355     |-1    |\n|1      |356     |-1    |\n|1      |442     |-1    |\n|1      |487     |-1    |\n|1      |846     |-1    |\n|1      |936     |-1    |\n|1      |1546    |-1    |\n|1      |1692    |-1    |\n|1      |1836    |-1    |\n|1      |2001    |-1    |\n|1      |2025    |-1    |\n|1      |2144    |-1    |\n|1      |2787    |-1    |\n|1      |2993    |-1    |\n|1      |3455    |-1    |\n+-------+--------+------+\nonly showing top 20 rows\n\r\n+--------+---------------------------------------------------------+----------------------------------------------------------------------------+-----+--------+------+-------+\n|anime_id|name                                                     |genre                                                                       |type |episodes|rating|members|\n+--------+---------------------------------------------------------+----------------------------------------------------------------------------+-----+--------+------+-------+\n|32281   |Kimi no Na wa.                                           |Drama, Romance, School, Supernatural                                        |Movie|1       |9.37  |200630 |\n|5114    |Fullmetal Alchemist: Brotherhood                         |Action, Adventure, Drama, Fantasy, Magic, Military, Shounen                 |TV   |64      |9.26  |793665 |\n|28977   |Gintama°                                                 |Action, Comedy, Historical, Parody, Samurai, Sci-Fi, Shounen                |TV   |51      |9.25  |114262 |\n|9253    |Steins;Gate                                              |Sci-Fi, Thriller                                                            |TV   |24      |9.17  |673572 |\n|9969    |Gintama&#039;                                            |Action, Comedy, Historical, Parody, Samurai, Sci-Fi, Shounen                |TV   |51      |9.16  |151266 |\n|32935   |Haikyuu!!: Karasuno Koukou VS Shiratorizawa Gakuen Koukou|Comedy, Drama, School, Shounen, Sports                                      |TV   |10      |9.15  |93351  |\n|11061   |Hunter x Hunter (2011)                                   |Action, Adventure, Shounen, Super Power                                     |TV   |148     |9.13  |425855 |\n|820     |Ginga Eiyuu Densetsu                                     |Drama, Military, Sci-Fi, Space                                              |OVA  |110     |9.11  |80679  |\n|15335   |Gintama Movie: Kanketsu-hen - Yorozuya yo Eien Nare      |Action, Comedy, Historical, Parody, Samurai, Sci-Fi, Shounen                |Movie|1       |9.1   |72534  |\n|15417   |Gintama&#039;: Enchousen                                 |Action, Comedy, Historical, Parody, Samurai, Sci-Fi, Shounen                |TV   |13      |9.11  |81109  |\n|4181    |Clannad: After Story                                     |Drama, Fantasy, Romance, Slice of Life, Supernatural                        |TV   |24      |9.06  |456749 |\n|28851   |Koe no Katachi                                           |Drama, School, Shounen                                                      |Movie|1       |9.05  |102733 |\n|918     |Gintama                                                  |Action, Comedy, Historical, Parody, Samurai, Sci-Fi, Shounen                |TV   |201     |9.04  |336376 |\n|2904    |Code Geass: Hangyaku no Lelouch R2                       |Action, Drama, Mecha, Military, Sci-Fi, Super Power                         |TV   |25      |8.98  |572888 |\n|28891   |Haikyuu!! Second Season                                  |Comedy, Drama, School, Shounen, Sports                                      |TV   |25      |8.93  |179342 |\n|199     |Sen to Chihiro no Kamikakushi                            |Adventure, Drama, Supernatural                                              |Movie|1       |8.93  |466254 |\n|23273   |Shigatsu wa Kimi no Uso                                  |Drama, Music, Romance, School, Shounen                                      |TV   |22      |8.92  |416397 |\n|24701   |Mushishi Zoku Shou 2nd Season                            |Adventure, Fantasy, Historical, Mystery, Seinen, Slice of Life, Supernatural|TV   |10      |8.88  |75894  |\n|12355   |Ookami Kodomo no Ame to Yuki                             |Fantasy, Slice of Life                                                      |Movie|1       |8.84  |226193 |\n|1575    |Code Geass: Hangyaku no Lelouch                          |Action, Mecha, Military, School, Sci-Fi, Super Power                        |TV   |25      |8.83  |715151 |\n+--------+---------------------------------------------------------+----------------------------------------------------------------------------+-----+--------+------+-------+\nonly showing top 20 rows\n\r\n"}]},"apps":[],"jobName":"paragraph_1569255825835_-796531878","id":"20190924-012345_1014673291","dateCreated":"2019-09-24T01:23:45+0900","dateStarted":"2019-09-25T21:46:32+0900","dateFinished":"2019-09-25T21:48:09+0900","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:556","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.56.1:4040/jobs/job?id=0","http://192.168.56.1:4040/jobs/job?id=1","http://192.168.56.1:4040/jobs/job?id=2","http://192.168.56.1:4040/jobs/job?id=3","http://192.168.56.1:4040/jobs/job?id=4","http://192.168.56.1:4040/jobs/job?id=5"],"interpreterSettingId":"spark"}}},{"text":"ratings.createOrReplaceTempView(\"ratings\")\nanime.createOrReplaceTempView(\"anime\")","user":"anonymous","dateUpdated":"2019-09-25T21:48:27+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1569265628975_-1613640163","id":"20190924-040708_1909133067","dateCreated":"2019-09-24T04:07:08+0900","dateStarted":"2019-09-25T21:48:27+0900","dateFinished":"2019-09-25T21:48:29+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:557"},{"text":"val ratingsExplicit = spark.sql(\"\"\"\n    SELECT user_id, anime_id, rating\n    FROM ratings\n    WHERE rating >= 8\n    \"\"\")\nratingsExplicit.show()","user":"anonymous","dateUpdated":"2019-09-25T21:48:34+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ratingsExplicit: org.apache.spark.sql.DataFrame = [user_id: int, anime_id: int ... 1 more field]\n+-------+--------+------+\n|user_id|anime_id|rating|\n+-------+--------+------+\n|      1|    8074|    10|\n|      1|   11617|    10|\n|      1|   11757|    10|\n|      1|   15451|    10|\n|      2|   11771|    10|\n|      3|      20|     8|\n|      3|     170|     9|\n|      3|     199|    10|\n|      3|     225|     9|\n|      3|     813|    10|\n|      3|    1132|     8|\n|      3|    1313|     8|\n|      3|    1535|    10|\n|      3|    1689|     8|\n|      3|    1943|     8|\n|      3|    3588|     8|\n|      3|    5114|    10|\n|      3|    5231|     8|\n|      3|    6702|     8|\n|      3|    9760|     9|\n+-------+--------+------+\nonly showing top 20 rows\n\r\n"}]},"apps":[],"jobName":"paragraph_1569261739535_-2040808347","id":"20190924-030219_1925824171","dateCreated":"2019-09-24T03:02:19+0900","dateStarted":"2019-09-25T21:48:34+0900","dateFinished":"2019-09-25T21:48:36+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:558","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.56.1:4040/jobs/job?id=6"],"interpreterSettingId":"spark"}}},{"text":"val joinExpression = \"anime_id\"\nval joinType = \"inner\"\nval ratings2 = ratingsExplicit.join(anime.select(\"anime_id\", \"name\"), Seq(\"anime_id\"), joinType)\nratings2.show()","user":"anonymous","dateUpdated":"2019-09-25T21:48:39+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"joinExpression: String = anime_id\njoinType: String = inner\nratings2: org.apache.spark.sql.DataFrame = [anime_id: int, user_id: int ... 2 more fields]\n+--------+-------+------+--------------------+\n|anime_id|user_id|rating|                name|\n+--------+-------+------+--------------------+\n|    8074|      1|    10|Highschool of the...|\n|   11617|      1|    10|     High School DxD|\n|   11757|      1|    10|    Sword Art Online|\n|   15451|      1|    10| High School DxD New|\n|   11771|      2|    10|    Kuroko no Basket|\n|      20|      3|     8|              Naruto|\n|     170|      3|     9|           Slam Dunk|\n|     199|      3|    10|Sen to Chihiro no...|\n|     225|      3|     9|      Dragon Ball GT|\n|     813|      3|    10|       Dragon Ball Z|\n|    1132|      3|     8|    Digimon Frontier|\n|    1313|      3|     8|Digimon Adventure 02|\n|    1535|      3|    10|          Death Note|\n|    1689|      3|     8|Byousoku 5 Centim...|\n|    1943|      3|     8|             Paprika|\n|    3588|      3|     8|          Soul Eater|\n|    5114|      3|    10|Fullmetal Alchemi...|\n|    5231|      3|     8|      Inazuma Eleven|\n|    6702|      3|     8|          Fairy Tail|\n|    9760|      3|     9|  Hoshi wo Ou Kodomo|\n+--------+-------+------+--------------------+\nonly showing top 20 rows\n\r\n"}]},"apps":[],"jobName":"paragraph_1569255842805_327926312","id":"20190924-012402_1955656443","dateCreated":"2019-09-24T01:24:02+0900","dateStarted":"2019-09-25T21:48:39+0900","dateFinished":"2019-09-25T21:48:43+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:559","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.56.1:4040/jobs/job?id=7","http://192.168.56.1:4040/jobs/job?id=8"],"interpreterSettingId":"spark"}}},{"text":"val userAnime = ratings2.groupBy(\"user_id\").pivot(\"anime_id\").agg(first(\"rating\")).na.fill(\"0\")","user":"anonymous","dateUpdated":"2019-09-25T21:48:48+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"userAnime: org.apache.spark.sql.DataFrame = [user_id: int, 1: int ... 8264 more fields]\n"}]},"apps":[],"jobName":"paragraph_1569260450049_1161247557","id":"20190924-024050_955920773","dateCreated":"2019-09-24T02:40:50+0900","dateStarted":"2019-09-25T21:48:48+0900","dateFinished":"2019-09-25T21:50:19+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:560","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.56.1:4040/jobs/job?id=9","http://192.168.56.1:4040/jobs/job?id=10","http://192.168.56.1:4040/jobs/job?id=11","http://192.168.56.1:4040/jobs/job?id=12","http://192.168.56.1:4040/jobs/job?id=13","http://192.168.56.1:4040/jobs/job?id=14","http://192.168.56.1:4040/jobs/job?id=15"],"interpreterSettingId":"spark"}}},{"text":"userAnime.columns.size","user":"anonymous","dateUpdated":"2019-09-25T21:50:37+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res15: Int = 8266\n"}]},"apps":[],"jobName":"paragraph_1569267318332_-82626502","id":"20190924-043518_1506647166","dateCreated":"2019-09-24T04:35:18+0900","dateStarted":"2019-09-25T21:50:37+0900","dateFinished":"2019-09-25T21:50:38+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:561"},{"text":"import org.apache.spark.ml.feature.VectorAssembler\n\nval inputCols = userAnime.columns.filter(_ != \"user_id\")\nval assembler = new VectorAssembler().setInputCols(inputCols).setOutputCol(\"featureVector\")\n\nval assembledUserAnime = assembler.transform(userAnime).select(\"featureVector\")\n//assembledUserAnime.select(\"featureVector\").show(truncate = false)","user":"anonymous","dateUpdated":"2019-09-25T23:20:08+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.feature.VectorAssembler\ninputCols: Array[String] = Array(1, 5, 6, 7, 8, 15, 16, 17, 18, 19, 20, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 71, 72, 73, 74, 75, 76, 77, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 19...assembler: org.apache.spark.ml.feature.VectorAssembler = vecAssembler_743bf5bc3162\nassembledUserAnime: org.apache.spark.sql.DataFrame = [featureVector: vector]\n"}]},"apps":[],"jobName":"paragraph_1569267773046_1714447541","id":"20190924-044253_1434526472","dateCreated":"2019-09-24T04:42:53+0900","dateStarted":"2019-09-25T23:20:08+0900","dateFinished":"2019-09-25T23:20:25+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:562"},{"text":"assembledUserAnime.columns","user":"anonymous","dateUpdated":"2019-09-25T23:20:38+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res26: Array[String] = Array(featureVector)\n"}]},"apps":[],"jobName":"paragraph_1569308536734_598093783","id":"20190924-160216_55376782","dateCreated":"2019-09-24T16:02:16+0900","dateStarted":"2019-09-25T23:20:38+0900","dateFinished":"2019-09-25T23:20:39+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:563"},{"text":"import org.apache.spark.ml.feature.PCA\n\nval pca = new PCA().setInputCol(\"featureVector\").setOutputCol(\"pcaFeatures\").setK(3)","user":"anonymous","dateUpdated":"2019-09-25T23:20:48+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.feature.PCA\npca: org.apache.spark.ml.feature.PCA = pca_88144224ed9a\n"}]},"apps":[],"jobName":"paragraph_1569261547334_-757981338","id":"20190924-025907_546205306","dateCreated":"2019-09-24T02:59:07+0900","dateStarted":"2019-09-25T23:20:49+0900","dateFinished":"2019-09-25T23:20:50+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:565"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1569266476857_2074848745","id":"20190924-042116_1422225916","dateCreated":"2019-09-24T04:21:16+0900","status":"RUNNING","progressUpdateIntervalMs":500,"$$hashKey":"object:566","text":"val pcaResult = pca.fit(assembledUserAnime).transform(assembledUserAnime).select(\"pcaFeatures\")","dateUpdated":"2019-09-25T23:20:51+0900","dateStarted":"2019-09-25T23:20:51+0900","errorMessage":""},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1569421251610_-724269310","id":"20190925-232051_1289367167","dateCreated":"2019-09-25T23:20:51+0900","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2003"}],"name":"animeClustering","id":"2EQ8MJZZP","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}